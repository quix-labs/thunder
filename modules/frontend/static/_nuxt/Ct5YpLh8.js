import{_ as B,e as D,f as E,g as N,u as O}from"./CMxzE29a.js";import{h as T,ay as d,p as j,o as q,x as J,w as c,a as u,b as i,q as l,t as K,K as m,av as M,az as R,am as V,aw as C}from"./f4acREAI.js";import{u as G,F as f}from"./8qbHmU6a.js";import"./DlAUqK2U.js";const L={class:"flex space-x-4"},A={class:"flex gap-2 justify-end"},X=T({__name:"sources",setup(H){var k;const{status:v,data:p,refresh:n}=G(),g=(k=d())==null?void 0:k.isOpen,h=[{key:"id",label:"#",sortable:!0},{key:"excerpt",label:"Excerpt",sortable:!0},{key:"driver",label:"Driver",sortable:!0},{key:"actions"}],b=j(()=>{var s;return((s=p.value)==null?void 0:s.map(e=>({id:e.id,excerpt:e.excerpt,driver:e.driver})))||[]}),y=()=>{d().open(f,{mode:"create",onCreated:()=>n(),onUpdated:()=>n()})},w=s=>{var o;const e=(o=p.value)==null?void 0:o.find(t=>t.id===s);d().open(f,{mode:"read",source:e,onCreated:()=>n(),onUpdated:()=>n()})},S=s=>{var o;const e=(o=p.value)==null?void 0:o.find(t=>t.id===s);d().open(f,{mode:"edit",source:e,onCreated:()=>n(),onUpdated:()=>n()})},$=s=>{var o;const e=(o=p.value)==null?void 0:o.find(t=>t.id===s);d().open(f,{mode:"create",source:M({...JSON.parse(JSON.stringify(e))}),onCreated:()=>n(),onUpdated:()=>n()})},U=async s=>{var r;const{data:e,error:o,status:t}=await O(`/sources/${s}`,{method:"DELETE"});if(t.value==="error")C().add({color:"error",title:"Unable to delete source",description:(r=o.value)==null?void 0:r.message});else if(t.value==="success"){const _=e.value;C().add({color:"success",title:"Successfully deleted source",description:_.message})}await n()};return(s,e)=>{const o=D,t=R,r=V,_=E,z=N,F=B;return q(),J(F,{as:"section",id:"sources",ui:{body:"p-0 sm:p-0",header:"flex gap-x-2 justify-between items-center",footer:"text-sm leading-5 text-center"}},{header:c(()=>[e[3]||(e[3]=u("h1",null,"Sources",-1)),u("div",L,[i(o,{kbds:["r"],label:"Refresh",color:"info",variant:"soft",icon:"i-heroicons-arrow-path-20-solid",onClick:e[0]||(e[0]=()=>l(n)()),loading:l(v)==="pending"||l(v)==="idle"},null,8,["loading"]),i(o,{kbds:["c"],label:"Create",variant:"soft","leading-icon":"i-heroicons-plus",disabled:l(g),onClick:e[1]||(e[1]=()=>y())},null,8,["disabled"])])]),footer:c(()=>{var a;return[e[4]||(e[4]=u("span",{class:"font-medium"},"Total: ",-1)),u("span",null,K(((a=l(b))==null?void 0:a.length)||0)+" sources",1)]}),default:c(()=>[i(z,{class:"flex-1",columns:h,rows:l(b),loading:["idle","pending"].includes(l(v)),sorting:[{desc:!0,id:"id"}]},{"cell-driver":c(({row:a})=>[i(t,{size:"sm",label:a.driver,color:"secondary",variant:"subtle"},null,8,["label"])]),"cell-actions":c(({row:a})=>[u("div",A,[i(_,{items:[[{label:"Replicate",onSelect:()=>$(a.id)}]],onClick:e[2]||(e[2]=m(()=>{},["stop"]))},{default:c(()=>[i(r,{icon:"i-heroicons-ellipsis-horizontal",variant:"link",color:"neutral",class:"p-0",size:"xl"})]),_:2},1032,["items"]),i(r,{icon:"i-heroicons-eye",variant:"link",color:"neutral",size:"xl",onClick:m(x=>w(a.id),["stop","prevent"]),class:"p-0"},null,8,["onClick"]),i(r,{icon:"i-heroicons-pencil-square",variant:"link",color:"neutral",size:"xl",onClick:m(x=>S(a.id),["stop","prevent"]),class:"p-0"},null,8,["onClick"]),i(r,{icon:"i-heroicons-trash",variant:"link",color:"error",size:"xl",onClick:m(x=>U(a.id),["stop","prevent"]),class:"p-0"},null,8,["onClick"])])]),_:1},8,["rows","loading"])]),_:1})}}});export{X as default};
