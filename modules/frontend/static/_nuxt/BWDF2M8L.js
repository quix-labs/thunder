import{g as j,h as S,i as A,N as L,r as N,G as T,p as D,k as G,o as u,x as w,w as s,q as t,b7 as q,B as y,y as b,b as v,b8 as M,b9 as H,v as k,ba as J,z as E,bb as Q,c as R,bc as X,d as O,t as I,bd as Y,be as K,ah as z,aQ as W,aR as Z,bf as ee,C as te,ae as oe,bo as ae,ai as se,aS as le,am as re,aj as U,bp as ne}from"./Cukv67TD.js";import{f as ie,u as ce,b as ue}from"./BtAH9O33.js";import{_ as de}from"./BDl_M9a8.js";const pe={slots:{overlay:"fixed inset-0 bg-[var(--ui-bg-elevated)]/75",content:"fixed w-full h-dvh bg-[var(--ui-bg)] divide-y divide-[var(--ui-border)] flex flex-col focus:outline-none",header:"px-4 py-5 sm:px-6",body:"flex-1 p-4 sm:p-6",footer:"flex items-center gap-1.5 p-4 sm:px-6",title:"text-[var(--ui-text-highlighted)] font-semibold",description:"mt-1 text-[var(--ui-text-muted)] text-sm",close:"absolute top-4 right-4"},variants:{transition:{true:{overlay:"data-[state=open]:animate-[fade-in_200ms_ease-out] data-[state=closed]:animate-[fade-out_200ms_ease-in]",content:"data-[state=open]:animate-[scale-in_200ms_ease-out] data-[state=closed]:animate-[scale-out_200ms_ease-in]"}},fullscreen:{true:{content:"inset-0"},false:{content:"top-[50%] left-[50%] translate-x-[-50%] translate-y-[-50%] sm:max-w-lg sm:h-auto sm:my-8 sm:rounded-[calc(var(--ui-radius)*2)] sm:shadow-lg sm:ring ring-[var(--ui-border)]"}}}},me=te;var P;const fe=j({extend:j(pe),...((P=me.ui)==null?void 0:P.modal)||{}}),ve=S({__name:"Modal",props:{title:{},description:{},content:{},overlay:{type:Boolean,default:!0},transition:{type:Boolean,default:!0},fullscreen:{type:Boolean},portal:{type:Boolean,default:!0},close:{type:Boolean,default:!0},closeIcon:{},preventClose:{type:Boolean},class:{},ui:{},open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean,default:!0}},emits:["update:open"],setup($,{emit:h}){const o=$,B=h,l=A(),V=L(N(o,"open","defaultOpen","modal"),B),C=T(()=>o.content),d=D(()=>o.preventClose?{pointerDownOutside:e=>e.preventDefault(),interactOutside:e=>e.preventDefault()}:{}),x=G(),r=D(()=>fe({transition:o.transition,fullscreen:o.fullscreen}));return(e,n)=>(u(),w(t(ee),W(Z(t(V))),{default:s(({open:i})=>[l.default?(u(),w(t(q),{key:0,"as-child":""},{default:s(()=>[y(e.$slots,"default",{open:i})]),_:2},1024)):b("",!0),v(t(M),{disabled:!e.portal},{default:s(()=>{var p,_;return[e.overlay?(u(),w(t(H),{key:0,class:k(r.value.overlay({class:(p=o.ui)==null?void 0:p.overlay}))},null,8,["class"])):b("",!0),v(t(J),E({class:r.value.content({class:[o.class,(_=o.ui)==null?void 0:_.content]})},C.value,Q(d.value)),{default:s(()=>[y(e.$slots,"content",{},()=>{var g,c,m;return[l.header||e.title||l.title||e.description||l.description||e.close||l.close?(u(),R("div",{key:0,class:k(r.value.header({class:(g=o.ui)==null?void 0:g.header}))},[y(e.$slots,"header",{},()=>{var a,f;return[e.title||l.title?(u(),w(t(X),{key:0,class:k(r.value.title({class:(a=o.ui)==null?void 0:a.title}))},{default:s(()=>[y(e.$slots,"title",{},()=>[O(I(e.title),1)])]),_:3},8,["class"])):b("",!0),e.description||l.description?(u(),w(t(Y),{key:1,class:k(r.value.description({class:(f=o.ui)==null?void 0:f.description}))},{default:s(()=>[y(e.$slots,"description",{},()=>[O(I(e.description),1)])]),_:3},8,["class"])):b("",!0),v(t(K),{"as-child":""},{default:s(()=>[y(e.$slots,"close",{ui:r.value},()=>{var F;return[e.close?(u(),w(z,E({key:0,icon:e.closeIcon||t(x).ui.icons.close,size:"md",color:"neutral",variant:"ghost","aria-label":"Close"},typeof e.close=="object"?e.close:void 0,{class:r.value.close({class:(F=o.ui)==null?void 0:F.close})}),null,16,["icon","class"])):b("",!0)]})]),_:3})]})],2)):b("",!0),l.body?(u(),R("div",{key:1,class:k(r.value.body({class:(c=o.ui)==null?void 0:c.body}))},[y(e.$slots,"body")],2)):b("",!0),l.footer?(u(),R("div",{key:2,class:k(r.value.footer({class:(m=o.ui)==null?void 0:m.footer}))},[y(e.$slots,"footer")],2)):b("",!0)]})]),_:3},16,["class"])]}),_:3},8,["disabled"])]),_:3},16))}}),ye=$=>oe("exporters","/exporters",void 0,$),we=S({__name:"DownloadProcessorForm",props:{processorId:{}},async setup($){var e;let h,o;const{data:B,status:l,error:V}=([h,o]=ae(()=>ye({lazy:!1})),h=await h,o(),h),C=$,d=se({exporter:l.value==="success"&&B.value?(e=Object.keys(B.value))==null?void 0:e.at(0):null,filename:null}),x=D(()=>{var n;return`processor-${C.processorId}.${(n=d.exporter)==null?void 0:n.replace("thunder.","")}`}),r=async()=>{var g;const n={...le(d)};n.filename||(n.filename=x.value);const{data:i,error:p,status:_}=await ce(`processors/${C.processorId}/download`,{params:n,responseType:"blob"});if((g=re())==null||g.close(),_.value==="success"&&i.value){const c=()=>{const m=window.URL.createObjectURL(i.value),a=document.createElement("a");a.href=m,a.download=n.filename,a.click(),setTimeout(()=>{window.URL.revokeObjectURL(m)},0)};c(),U().add({color:"success",title:"File Ready for Download",close:!1,actions:[{icon:"i-heroicons-arrow-down-tray",label:"Download file",color:"primary",variant:"outline",onClick:c}]})}else if(p.value)if(p.value.data instanceof Blob){const c=new FileReader;c.onload=m=>{var a;try{const f=JSON.parse(((a=m.target)==null?void 0:a.result)||"null");U().add({title:"Failed to generate file",description:f.error||"An unknown error occurred.",color:"error"})}catch{U().add({title:"Failed to generate file",description:"Error parsing the error response.",color:"error"})}},c.readAsText(p.value.data)}else U().add({title:"Failed to generate file",description:p.value.message,color:"error"})};return(n,i)=>{const p=ne,_=ue,g=de,c=z,m=ve;return u(),w(m,{title:`Download data for processor nÂ°${n.processorId}`},{body:s(()=>[v(t(ie),{state:t(d),onSubmit:r,class:"space-y-4"},{default:s(()=>[v(_,{label:"Exporter",name:"exporter",required:""},{default:s(()=>{var a;return[v(p,{modelValue:t(d).exporter,"onUpdate:modelValue":i[0]||(i[0]=f=>t(d).exporter=f),items:(a=Object.entries(t(B)||{}))==null?void 0:a.map(([f,F])=>({label:F,value:f,description:"test"})),required:""},null,8,["modelValue","items"])]}),_:1}),v(_,{label:"Filename",name:"filename"},{default:s(()=>[v(g,{placeholder:t(x),modelValue:t(d).filename,"onUpdate:modelValue":i[1]||(i[1]=a=>t(d).filename=a)},null,8,["placeholder","modelValue"])]),_:1}),v(c,{type:"submit",class:"p-3 cursor-pointer",block:"","loading-auto":""},{default:s(()=>i[2]||(i[2]=[O(" Generate file ")])),_:1})]),_:1},8,["state"])]),_:1},8,["title"])}}});export{we as default};
