import{a as B,_ as D,b as E}from"./B7Dajo9s.js";import{e as N,aw as d,h as O,o as T,i as j,w as c,a as p,b as i,j as l,t as J,k as m,x as M,n as C,ay as R,p as V}from"./CmCqKDSp.js";import{_ as q,u as G}from"./CzVMdW3V.js";import{u as K,F as f}from"./DY_0w8dX.js";import"./D3nfvcBV.js";import"./DoQG-NxU.js";import"./EBrLb2w8.js";import"./DlAUqK2U.js";const L={class:"flex space-x-4"},A={class:"flex gap-2 justify-end"},oe=N({__name:"sources",setup(H){var k;const{status:v,data:u,refresh:t}=K(),g=(k=d())==null?void 0:k.isOpen,h=[{key:"id",label:"#",sortable:!0},{key:"excerpt",label:"Excerpt",sortable:!0},{key:"driver",label:"Driver",sortable:!0},{key:"actions"}],b=O(()=>{var s;return((s=u.value)==null?void 0:s.map(e=>({id:e.id,excerpt:e.excerpt,driver:e.driver})))||[]}),y=()=>{d().open(f,{mode:"create",onCreated:()=>t(),onUpdated:()=>t()})},w=s=>{var o;const e=(o=u.value)==null?void 0:o.find(n=>n.id===s);d().open(f,{mode:"read",source:e,onCreated:()=>t(),onUpdated:()=>t()})},S=s=>{var o;const e=(o=u.value)==null?void 0:o.find(n=>n.id===s);d().open(f,{mode:"edit",source:e,onCreated:()=>t(),onUpdated:()=>t()})},$=s=>{var o;const e=(o=u.value)==null?void 0:o.find(n=>n.id===s);d().open(f,{mode:"create",source:M({...JSON.parse(JSON.stringify(e))}),onCreated:()=>t(),onUpdated:()=>t()})},U=async s=>{var r;const{data:e,error:o,status:n}=await G(`/sources/${s}`,{method:"DELETE"});if(n.value==="error")C().add({color:"error",title:"Unable to delete source",description:(r=o.value)==null?void 0:r.message});else if(n.value==="success"){const _=e.value;C().add({color:"success",title:"Successfully deleted source",description:_.message})}await t()};return(s,e)=>{const o=B,n=R,r=V,_=D,F=E,z=q;return T(),j(z,{as:"section",id:"sources",ui:{body:"p-0 sm:p-0",header:"flex gap-x-2 justify-between items-center",footer:"text-sm leading-5 text-center"}},{header:c(()=>[e[3]||(e[3]=p("h1",null,"Sources",-1)),p("div",L,[i(o,{kbds:["r"],label:"Refresh",color:"info",variant:"soft",icon:"i-heroicons-arrow-path-20-solid",onClick:e[0]||(e[0]=()=>l(t)()),loading:l(v)==="pending"||l(v)==="idle"},null,8,["loading"]),i(o,{kbds:["c"],label:"Create",variant:"soft","leading-icon":"i-heroicons-plus",disabled:l(g),onClick:e[1]||(e[1]=()=>y())},null,8,["disabled"])])]),footer:c(()=>{var a;return[e[4]||(e[4]=p("span",{class:"font-medium"},"Total: ",-1)),p("span",null,J(((a=l(b))==null?void 0:a.length)||0)+" sources",1)]}),default:c(()=>[i(F,{class:"flex-1",columns:h,rows:l(b),loading:["idle","pending"].includes(l(v)),sorting:[{desc:!0,id:"id"}]},{"cell-driver":c(({row:a})=>[i(n,{size:"sm",label:a.driver,color:"secondary",variant:"subtle"},null,8,["label"])]),"cell-actions":c(({row:a})=>[p("div",A,[i(_,{items:[[{label:"Replicate",onSelect:()=>$(a.id)}]],onClick:e[2]||(e[2]=m(()=>{},["stop"]))},{default:c(()=>[i(r,{icon:"i-heroicons-ellipsis-horizontal",variant:"link",color:"neutral",class:"p-0",size:"xl"})]),_:2},1032,["items"]),i(r,{icon:"i-heroicons-eye",variant:"link",color:"neutral",size:"xl",onClick:m(x=>w(a.id),["stop","prevent"]),class:"p-0"},null,8,["onClick"]),i(r,{icon:"i-heroicons-pencil-square",variant:"link",color:"neutral",size:"xl",onClick:m(x=>S(a.id),["stop","prevent"]),class:"p-0"},null,8,["onClick"]),i(r,{icon:"i-heroicons-trash",variant:"link",color:"error",size:"xl",onClick:m(x=>U(a.id),["stop","prevent"]),class:"p-0"},null,8,["onClick"])])]),_:1},8,["rows","loading"])]),_:1})}}});export{oe as default};
