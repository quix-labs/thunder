import{h as E,g as N,r as _,o as O,c as S,b as o,w as l,O as s,W as V,P as u,d as F,a as f,t as M,Z as R,$ as y}from"./CpwuFn8I.js";import{a as j,_ as q,b as A}from"./BThLqm6A.js";import{_ as G,c as I}from"./DN-EXmkR.js";import{u as L,_ as P}from"./Lzw9FGg6.js";import"./CeB_s2cw.js";const W={class:"flex flex-col flex-1"},Z=f("h1",{class:"font-semibold text-xl text-gray-900 dark:text-white leading-tight"},"Targets",-1),H={class:"flex gap-1"},J=f("span",{class:"font-medium"},"Total: ",-1),ae=E({__name:"targets",setup(K){const{status:k,data:p,refresh:g}=L(),C=[{key:"id",label:"#",sortable:!0,rowClass:"w-[1px] whitespace-nowrap"},{key:"name",label:"Name",sortable:!0},{key:"driver",label:"Driver",sortable:!0},{key:"actions",sortable:!1,rowClass:"w-[1px] whitespace-nowrap"}],b=N(()=>{var t;return((t=p.value)==null?void 0:t.map((e,n)=>({id:n,name:"TODO name",driver:e.driver})))||[]}),r=_(!1),i=_("create"),d=_(),c=_(),T=()=>{i.value="create",d.value=void 0,c.value=void 0,r.value=!0},h=t=>{var e;i.value="read",d.value=(e=p.value)==null?void 0:e.at(t),c.value=t,r.value=!0},U=t=>{var e;i.value="edit",d.value=(e=p.value)==null?void 0:e.at(t),c.value=t,r.value=!0},$=t=>{var e;i.value="create",d.value={...(e=p.value)==null?void 0:e.at(t)},c.value=void 0,r.value=!0},z=async t=>{var m;const{data:e,error:n,status:v}=await I(`/targets/${t}`,{method:"DELETE"});if(v.value==="error")y().add({color:"red",title:"Unable to delete target",description:(m=n.value)==null?void 0:m.message});else if(v.value==="success"){const x=e.value;y().add({color:"green",title:"Successfully deleted target",description:x.message})}await g()};return(t,e)=>{const n=R,v=j,m=q,x=A,D=G,B=P;return O(),S("section",W,[o(D,{class:"w-full",ui:{divide:"divide-y divide-gray-200 dark:divide-gray-700",body:{padding:""},header:{base:"flex gap-x-2 justify-between items-center"},footer:{base:"text-sm leading-5 text-center"}}},{header:l(()=>[Z,o(n,{onClick:u(T,["prevent"]),variant:"soft"},{default:l(()=>[F("+ Add Target")]),_:1})]),default:l(()=>[o(x,{onSelect:e[1]||(e[1]=a=>h(a.id)),columns:C,rows:s(b),sort:{column:"id",direction:"desc"},loading:s(k)==="pending"||s(k)==="idle"},{"driver-data":l(({row:a})=>[o(v,{size:"xs",label:a.driver,color:"sky",variant:"subtle"},null,8,["label"])]),"actions-data":l(({row:a})=>[f("div",H,[o(m,{items:[[{label:"Replicate",click:()=>$(a.id)}]],onClick:e[0]||(e[0]=u(()=>{},["stop"]))},{default:l(()=>[o(n,{icon:"i-heroicons-ellipsis-horizontal",variant:"link",color:"gray",size:"xl",padded:!1})]),_:2},1032,["items"]),o(n,{icon:"i-heroicons-eye",variant:"link",color:"gray",size:"xl",padded:!1,onClick:u(w=>h(a.id),["stop","prevent"])},null,8,["onClick"]),o(n,{icon:"i-heroicons-pencil-square",variant:"link",color:"gray",size:"xl",padded:!1,onClick:u(w=>U(a.id),["stop","prevent"])},null,8,["onClick"]),o(n,{icon:"i-heroicons-trash",variant:"link",color:"red",size:"xl",padded:!1,onClick:u(w=>z(a.id),["stop","prevent"])},null,8,["onClick"])])]),_:1},8,["rows","loading"])]),footer:l(()=>{var a;return[J,f("span",null,M(((a=s(b))==null?void 0:a.length)||0)+" targets",1)]}),_:1}),o(B,{onUpdated:s(g),onCreated:s(g),mode:s(i),opened:s(r),"onUpdate:opened":e[2]||(e[2]=a=>V(r)?r.value=a:null),target:s(d),"processor-id":s(c)},null,8,["onUpdated","onCreated","mode","opened","target","processor-id"])])}}});export{ae as default};
