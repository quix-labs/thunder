const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CLkjOHtO.js","./B5YJUb8b.js","./BTDLtqxA.js","./entry.DSrKHs56.css","./DwWviSL3.js","./useGoFetch.Cg6qBO-I.css","./DowyIwUz.js","./2qzIFZIX.js","./useSources.Be7ST0Az.css","./D1wMMFWM.js","./useTargets.DHNXSrSi.css","./RightPanel.Q1vbOw9v.css","./CtQNujyh.js","./SamplePanel._o2deULb.css"])))=>i.map(i=>d[i]);
import{r as j,f as P,g as K,i as me,h as ve,s as fe,j as ge,k as ee,l as ye,m as X,E as be,A as he,T as xe,F as J,n as Y,_ as te,p as we,q as G,v as W,x as ke,y as ae,z as _e,B as $e,C as F,D as Se,G as oe,o as b,H as D,w as x,a as v,I as U,c as w,b as h,J as S,K as Ce,L as Pe,M as ne,N as m,O as k,t as z,d as B,P as se,Q as N,R as le,S as Z,U as ze,V as q,W as re,X as ie,Y as ue,Z as E}from"./BTDLtqxA.js";import{f as Ie,u as Te,_ as de,a as Ue,b as R,c as Ve,d as Me,e as Ee}from"./DwWviSL3.js";const De={base:"relative inline-flex flex-shrink-0 border-2 border-transparent disabled:cursor-not-allowed disabled:opacity-50 focus:outline-none",rounded:"rounded-full",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",active:"bg-{color}-500 dark:bg-{color}-400",inactive:"bg-gray-200 dark:bg-gray-700",size:{"2xs":"h-3 w-5",xs:"h-3.5 w-6",sm:"h-4 w-7",md:"h-5 w-9",lg:"h-6 w-11",xl:"h-7 w-[3.25rem]","2xl":"h-8 w-[3.75rem]"},container:{base:"pointer-events-none relative inline-block rounded-full bg-white dark:bg-gray-900 shadow transform ring-0 transition ease-in-out duration-200",active:{"2xs":"translate-x-2 rtl:-translate-x-2",xs:"translate-x-2.5 rtl:-translate-x-2.5",sm:"translate-x-3 rtl:-translate-x-3",md:"translate-x-4 rtl:-translate-x-4",lg:"translate-x-5 rtl:-translate-x-5",xl:"translate-x-6 rtl:-translate-x-6","2xl":"translate-x-7 rtl:-translate-x-7"},inactive:"translate-x-0 rtl:-translate-x-0",size:{"2xs":"h-2 w-2",xs:"h-2.5 w-2.5",sm:"h-3 w-3",md:"h-4 w-4",lg:"h-5 w-5",xl:"h-6 w-6","2xl":"h-7 w-7"}},icon:{base:"absolute inset-0 h-full w-full flex items-center justify-center transition-opacity",active:"opacity-100 ease-in duration-200",inactive:"opacity-0 ease-out duration-100",size:{"2xs":"h-2 w-2",xs:"h-2 w-2",sm:"h-2 w-2",md:"h-3 w-3",lg:"h-4 w-4",xl:"h-5 w-5","2xl":"h-6 w-6"},on:"text-{color}-500 dark:text-{color}-400",off:"text-gray-400 dark:text-gray-500",loading:"animate-spin text-{color}-500 dark:text-{color}-400"},default:{onIcon:null,offIcon:null,loadingIcon:"i-heroicons-arrow-path-20-solid",color:"primary",size:"md"}};function Oe(e,o,t){let d=j(t==null?void 0:t.value),r=P(()=>e.value!==void 0);return[P(()=>r.value?e.value:d.value),function(n){return r.value||(d.value=n),o==null?void 0:o(n)}]}function Ae(e={},o=null,t=[]){for(let[d,r]of Object.entries(e))pe(t,ce(o,d),r);return t}function ce(e,o){return e?e+"["+o+"]":o}function pe(e,o,t){if(Array.isArray(t))for(let[d,r]of t.entries())pe(e,ce(o,d.toString()),r);else t instanceof Date?e.push([o,t.toISOString()]):typeof t=="boolean"?e.push([o,t?"1":"0"]):typeof t=="string"?e.push([o,t]):typeof t=="number"?e.push([o,`${t}`]):t==null?e.push([o,""]):Ae(t,o,e)}function Be(e){var o,t;let d=(o=e==null?void 0:e.form)!=null?o:e.closest("form");if(d){for(let r of d.elements)if(r!==e&&(r.tagName==="INPUT"&&r.type==="submit"||r.tagName==="BUTTON"&&r.type==="submit"||r.nodeName==="INPUT"&&r.type==="image")){r.click();return}(t=d.requestSubmit)==null||t.call(d)}}let je=Symbol("GroupContext"),Ne=K({name:"Switch",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"button"},modelValue:{type:Boolean,default:void 0},defaultChecked:{type:Boolean,optional:!0},form:{type:String,optional:!0},name:{type:String,optional:!0},value:{type:String,optional:!0},id:{type:String,default:null},disabled:{type:Boolean,default:!1},tabIndex:{type:Number,default:0}},inheritAttrs:!1,setup(e,{emit:o,attrs:t,slots:d,expose:r}){var n;let s=(n=e.id)!=null?n:`headlessui-switch-${me()}`,u=ve(je,null),[l,c]=Oe(P(()=>e.modelValue),a=>o("update:modelValue",a),P(()=>e.defaultChecked));function p(){c(!l.value)}let I=j(null),_=u===null?I:u.switchRef,C=fe(P(()=>({as:e.as,type:t.type})),_);r({el:_,$el:_});function T(a){a.preventDefault(),p()}function M(a){a.key===Y.Space?(a.preventDefault(),p()):a.key===Y.Enter&&Be(a.currentTarget)}function f(a){a.preventDefault()}let i=P(()=>{var a,g;return(g=(a=ge(_))==null?void 0:a.closest)==null?void 0:g.call(a,"form")});return ee(()=>{ye([i],()=>{if(!i.value||e.defaultChecked===void 0)return;function a(){c(e.defaultChecked)}return i.value.addEventListener("reset",a),()=>{var g;(g=i.value)==null||g.removeEventListener("reset",a)}},{immediate:!0})}),()=>{let{name:a,value:g,form:$,tabIndex:V,...O}=e,L={checked:l.value},y={id:s,ref:_,role:"switch",type:C.value,tabIndex:V===-1?0:V,"aria-checked":l.value,"aria-labelledby":u==null?void 0:u.labelledby.value,"aria-describedby":u==null?void 0:u.describedby.value,onClick:T,onKeyup:M,onKeypress:f};return X(J,[a!=null&&l.value!=null?X(Ie,be({features:Te.Hidden,as:"input",type:"checkbox",hidden:!0,readOnly:!0,checked:l.value,form:$,disabled:O.disabled,name:a,value:g})):null,he({ourProps:y,theirProps:{...t,...xe(O,["modelValue","defaultChecked"])},slot:L,attrs:t,slots:d,name:"Switch"})])}}});const A=we(G.ui.strategy,G.ui.toggle,De),Ke=K({components:{HSwitch:Ne,UIcon:W},inheritAttrs:!1,props:{id:{type:String,default:null},name:{type:String,default:null},modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},onIcon:{type:String,default:()=>A.default.onIcon},offIcon:{type:String,default:()=>A.default.offIcon},loadingIcon:{type:String,default:()=>A.default.loadingIcon},color:{type:String,default:()=>A.default.color,validator(e){return G.ui.colors.includes(e)}},size:{type:String,default:()=>A.default.size,validator(e){return Object.keys(A.size).includes(e)}},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:o}){const{ui:t,attrs:d}=ke("toggle",ae(e,"ui"),A),{emitFormChange:r,color:n,inputId:s,name:u}=_e(e),l=P({get(){return e.modelValue},set(T){o("update:modelValue",T),o("change",T),r()}}),c=P(()=>$e(F(t.value.base,t.value.size[e.size],t.value.rounded,n.value&&t.value.ring.replaceAll("{color}",n.value),n.value&&(l.value?t.value.active:t.value.inactive).replaceAll("{color}",n.value)),e.class)),p=P(()=>F(t.value.container.base,t.value.container.size[e.size],l.value?t.value.container.active[e.size]:t.value.container.inactive)),I=P(()=>F(t.value.icon.size[e.size],n.value&&t.value.icon.on.replaceAll("{color}",n.value))),_=P(()=>F(t.value.icon.size[e.size],n.value&&t.value.icon.off.replaceAll("{color}",n.value))),C=P(()=>F(t.value.icon.size[e.size],n.value&&t.value.icon.loading.replaceAll("{color}",n.value)));return Se(()=>Pe()),{ui:t,attrs:d,name:u,inputId:s,active:l,switchClass:c,containerClass:p,onIconClass:I,offIconClass:_,loadingIconClass:C}}});function Le(e,o,t,d,r,n){const s=W,u=oe("HSwitch");return b(),D(u,Ce({id:e.inputId,modelValue:e.active,"onUpdate:modelValue":o[0]||(o[0]=l=>e.active=l),name:e.name,disabled:e.disabled||e.loading,class:e.switchClass},e.attrs),{default:x(()=>[v("span",{class:U(e.containerClass)},[e.loading?(b(),w("span",{key:0,class:U([e.ui.icon.active,e.ui.icon.base]),"aria-hidden":"true"},[h(s,{name:e.loadingIcon,class:U(e.loadingIconClass)},null,8,["name","class"])],2)):S("",!0),!e.loading&&e.onIcon?(b(),w("span",{key:1,class:U([e.active?e.ui.icon.active:e.ui.icon.inactive,e.ui.icon.base]),"aria-hidden":"true"},[h(s,{name:e.onIcon,class:U(e.onIconClass)},null,8,["name","class"])],2)):S("",!0),!e.loading&&e.offIcon?(b(),w("span",{key:2,class:U([e.active?e.ui.icon.inactive:e.ui.icon.active,e.ui.icon.base]),"aria-hidden":"true"},[h(s,{name:e.offIcon,class:U(e.offIconClass)},null,8,["name","class"])],2)):S("",!0)],2)]),_:1},16,["id","modelValue","name","disabled","class"])}const Fe=te(Ke,[["render",Le]]);function Q(){return ne("process-form",()=>ae({activeTabs:"source",preventScroll:!1,shortMode:!1,liveReload:!0,showSamplePanel:!0}))}const Re={key:2,class:"italic opacity-60"},He={key:3},qe={key:0,class:"text-gray-400 ml-2"},Ge=["onKeydown","onClick"],Je={key:0,class:"italic text-sm"},We={key:1},Qe={key:1,class:"inline-flex items-baseline relative"},Xe=K({__name:"MappingThree",props:{mapping:{default:()=>[]},name:{},as:{},path:{}},setup(e){const o=j(!1),t=Q(),d=async s=>{t.value.activeTabs="mapping",t.value.activeMappingPath=r(s)},r=s=>[e.path,s].filter(u=>u).join("."),n=s=>{var u;return((u=t.value.activeMappingPath)==null?void 0:u.startsWith(r(s)+"."))||t.value.activeMappingPath===r(s)||r(s)===""};return(s,u)=>{const l=W,c=oe("MappingThree",!0);return b(),w("div",{tabindex:"0",class:U(["text-sm leading-tight",{"font-bold":r("")===(m(t).activeMappingPath||"")}]),onClick:u[3]||(u[3]=k(p=>d(""),["prevent","stop"])),onKeydown:u[4]||(u[4]=N(k(p=>d(""),["prevent","stop"]),["enter","space"]))},[v("div",{class:U(["inline-flex items-baseline leading-normal relative w-full dark:hover:bg-white/5 hover:bg-primary/5",{underline:r("")===(m(t).activeMappingPath||"")}])},[s.path&&!m(o)?(b(),D(l,{key:0,class:"carret hover:text-sky-600",name:"i-heroicons-chevron-down",onClick:u[0]||(u[0]=k(p=>o.value=!0,["prevent","stop"]))})):s.path?(b(),D(l,{key:1,class:"carret hover:text-sky-600",name:"i-heroicons-chevron-right",onClick:u[1]||(u[1]=k(p=>o.value=!1,["prevent","stop"]))})):S("",!0),s.name&&s.name!==s.as?(b(),w("span",Re,z(s.name)+": ",1)):S("",!0),s.as?(b(),w("span",He,z(s.as)+" ",1)):S("",!0),v("p",{onClick:u[2]||(u[2]=k(p=>o.value=!m(o),["prevent","stop"])),class:"hover:text-sky-600"},[B(z(m(o)?"{...}":"{")+" ",1),m(o)?(b(),w("span",qe,z(s.mapping.length>=2?`// ${s.mapping.length} items`:`// ${s.mapping.length} item`),1)):S("",!0)])],2),m(o)?S("",!0):(b(!0),w(J,{key:0},se(s.mapping,p=>(b(),w("div",{class:U(["pl-4 cursor-pointer dark:hover:bg-white/5 hover:bg-primary/5",{"border-l border-dashed":!0,"border-sky-600 dark:border-green-400/60":n(""),"border-[#bfcbd9]":!n("")}])},[p._type==="simple"?(b(),w("p",{key:0,class:U({"font-bold underline":r(p.column)===(m(t).activeMappingPath||"")}),onKeydown:N(k(I=>d(p.column),["prevent","stop"]),["enter","space"]),onClick:k(I=>d(p.column),["prevent","stop"]),tabindex:"0"},[p.name&&p.name!==p.column?(b(),w("span",Je,z(p.name)+": ",1)):S("",!0),p.column?(b(),w("span",We,z(p.column),1)):S("",!0)],42,Ge)):p._type==="relation"?(b(),D(c,{key:1,mapping:p.mapping,name:p.table,as:p.name,path:r(p.name)},null,8,["mapping","name","as","path"])):S("",!0)],2))),256)),m(o)?S("",!0):(b(),w("span",Qe,"}"))],34)}}}),Ye=te(Xe,[["__scopeId","data-v-a6e5187f"]]),Ze={class:"flex flex-col flex-1 gap-y-4 max-h-screen overflow-auto p-4"},et={class:"font-semibold"},tt={class:"font-normal"},at={class:"font-semibold"},ot={class:"font-normal"},nt=K({__name:"LeftPanel",props:{form:{required:!0},formModifiers:{}},emits:["update:form"],setup(e){const o=le(e,"form"),t=Q();function d(r){t.value.activeTabs=r}return(r,n)=>{const s=de,u=Ye;return b(),w("div",Ze,[h(s,{tabindex:"0",class:"cursor-pointer",onClick:n[0]||(n[0]=k(l=>d("source"),["prevent"])),onKeydown:n[1]||(n[1]=N(l=>d("source"),["enter","space"])),ui:m(t).activeTabs==="source"?{ring:"ring-1 ring-primary dark:ring-primary"}:void 0},{header:x(()=>n[6]||(n[6]=[v("p",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Source ",-1),v("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Describe which data will be synchronized ",-1)])),default:x(()=>{var l;return[v("p",null,"Source: Source n°"+z(o.value.source),1),v("p",null,"Table: "+z(o.value.table||"---"),1),v("p",null,"Conditions: "+z(((l=o.value.conditions)==null?void 0:l.length)||"---")+" TODO",1)]}),_:1},8,["ui"]),h(s,{tabindex:"0",class:"flex-1 cursor-pointer",onClick:n[2]||(n[2]=k(l=>d("mapping"),["prevent"])),onKeydown:n[3]||(n[3]=N(l=>d("mapping"),["enter","space"])),ui:m(t).activeTabs==="mapping"?{ring:"ring-1 ring-primary dark:ring-primary"}:void 0},{header:x(()=>n[7]||(n[7]=[v("p",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Mapping ",-1),v("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Describe how to transform your relational data into unstructured documents ",-1)])),default:x(()=>[h(u,{mapping:o.value.mapping,name:o.value.table,as:o.value.index},null,8,["mapping","name","as"])]),_:1},8,["ui"]),h(s,{tabindex:"0",class:"cursor-pointer",onClick:n[4]||(n[4]=k(l=>d("output"),["prevent"])),onKeydown:n[5]||(n[5]=N(l=>d("output"),["enter","space"])),ui:m(t).activeTabs==="output"?{ring:"ring-1 ring-primary dark:ring-primary"}:void 0},{header:x(()=>n[8]||(n[8]=[v("p",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Output ",-1),v("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Describe how your data will be synchronized ",-1)])),default:x(()=>{var l,c;return[v("p",et,[n[9]||(n[9]=B(" Targets: ")),v("span",tt,z((c=(l=o.value.targets)==null?void 0:l.map(p=>`Target n°${p}`))==null?void 0:c.join(", ")),1)]),v("p",at,[n[10]||(n[10]=B(" Expected index: ")),v("span",ot,z(o.value.index),1)])]}),_:1},8,["ui"])])}}}),st=re(()=>ie(()=>import("./CLkjOHtO.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url).then(e=>e.default||e)),lt=re(()=>ie(()=>import("./CtQNujyh.js"),__vite__mapDeps([12,2,3,4,5,13]),import.meta.url).then(e=>e.default||e)),rt={class:"flex flex-col flex-1 relative"},it={class:"col-span-full flex justify-between border-b p-4"},ut={class:"flex gap-x-4"},dt={key:0,class:"flex items-center gap-x-4 cursor-pointer"},ct={class:"flex items-center gap-x-4 cursor-pointer"},pt=K({__name:"Complete",props:Z({mode:{default:"create"},processor:{}},{opened:{},openedModifiers:{}}),emits:Z(["created","updated"],["update:opened"]),setup(e,{emit:o}){const t=le(e,"opened"),d=o,r=Q(),n=ze({source:null,table:null,primary_keys:[],conditions:[],targets:[],index:null,mapping:[]}),s=P(()=>e.processor||n),u=async()=>{var l,c,p,I;if(e.mode==="create"){const{status:_,error:C,data:T}=await R("/processors",{method:"post",body:s,watch:!1});if(_.value==="success"){const M=T.value;E().add({title:"Success",color:"green",description:M.message}),d("created"),t.value=!1;return}_.value==="error"&&E().add({title:"Error",description:(l=C.value)==null?void 0:l.message,color:"red"})}else if(e.mode==="edit"){const{status:_,error:C,data:T}=await R(`/processors/${e.processor.id}`,{method:"put",body:s,watch:!1});if(_.value==="success"){const M=T.value;E().add({title:"Success",color:"green",description:M.message}),d("updated"),t.value=!1;return}_.value==="error"&&E().add({title:"Error",description:((p=(c=C==null?void 0:C.value)==null?void 0:c.data)==null?void 0:p.error)||((I=C.value)==null?void 0:I.message),color:"red"})}};return(l,c)=>{const p=Fe,I=nt,_=st,C=lt,T=ue,M=Ue;return b(),w("section",rt,[h(M,{modelValue:t.value,"onUpdate:modelValue":c[5]||(c[5]=f=>t.value=f),class:"overflow-y-auto",onKeydown:N(k(u,["ctrl","prevent"]),["enter"]),ui:m(r).showSamplePanel?l.mode==="read"?{width:"w-screen max-w-[40vw]"}:{width:"w-screen max-w-[70vw]"}:l.mode==="read"?{width:"w-screen max-w-[25vw]"}:{width:"w-screen max-w-[55vw]"}},{default:x(()=>{var f,i;return[v("div",{class:U(["grid min-h-screen grid-rows-[auto_1fr_auto]",{"grid-cols-[2fr_3fr]":l.mode!=="read"&&!m(r).showSamplePanel,"grid-cols-[2fr_3fr_15vw]":l.mode!=="read"&&m(r).showSamplePanel,"grid-cols-[1fr_15vw]":m(r).showSamplePanel&&l.mode=="read"}])},[v("div",it,[v("h2",{onClick:k(u,["prevent"]),class:"col-span-full text-center text-2xl font-semibold"},z({create:"New processor",edit:`Edit processor: ${(f=l.processor)==null?void 0:f.id}`,read:`Processor: ${(i=l.processor)==null?void 0:i.id}`}[l.mode]),1),v("div",ut,[l.mode!=="read"?(b(),w("label",dt,[c[6]||(c[6]=B(" Short Mode (beta): ")),h(p,{"on-icon":"i-heroicons-check-20-solid","off-icon":"i-heroicons-x-mark-20-solid",modelValue:m(r).shortMode,"onUpdate:modelValue":c[0]||(c[0]=a=>m(r).shortMode=a)},null,8,["modelValue"])])):S("",!0),v("label",ct,[c[7]||(c[7]=B(" Sample Tab: ")),h(p,{"on-icon":"i-heroicons-check-20-solid","off-icon":"i-heroicons-x-mark-20-solid",modelValue:m(r).showSamplePanel,"onUpdate:modelValue":c[1]||(c[1]=a=>m(r).showSamplePanel=a)},null,8,["modelValue"])])])]),h(I,{form:m(s),"onUpdate:form":c[2]||(c[2]=a=>q(s)?s.value=a:null)},null,8,["form"]),l.mode!=="read"?(b(),D(_,{key:0,form:m(s),"onUpdate:form":c[3]||(c[3]=a=>q(s)?s.value=a:null)},null,8,["form"])):S("",!0),m(r).showSamplePanel?(b(),D(C,{key:1,form:m(s),"onUpdate:form":c[4]||(c[4]=a=>q(s)?s.value=a:null)},null,8,["form"])):S("",!0),l.mode!=="read"?(b(),D(T,{key:2,class:"col-span-full",onClick:k(u,["prevent"]),size:"xl",block:"",ui:{rounded:""}},{default:x(()=>[B(z({create:"Create",edit:"Save changes"}[l.mode]),1)]),_:1})):S("",!0)],2)]}),_:1},8,["modelValue","onKeydown","ui"])])}}});function mt(){return R("/processors")}function vt(){const e=ne("events-source",()=>new EventSource("/go-api/events"));function o(t,d){var r;(r=e.value)==null||r.addEventListener(t,n=>{const s=JSON.parse(n.data);d(s)})}return{on:o}}const ft={class:"flex gap-1"},gt={class:"flex gap-1"},yt={class:"flex gap-1"},bt={class:"flex gap-1"},ht=K({__name:"processors",setup(e){const{status:o,data:t,refresh:d}=mt();ee(()=>{const{on:f}=vt();f("processor-updated",()=>{d()}),f("processor-indexed",i=>{E().add({color:"green",title:`Processor ${i} indexed`})})});const r=[{key:"id",label:"#",sortable:!0,rowClass:"w-[1px] whitespace-nowrap"},{key:"source",label:"Source",sortable:!0},{key:"index",label:"Index",sortable:!0},{key:"targets",label:"Targets",sortable:!1},{key:"stats",label:"Stats",sortable:!1},{key:"status",label:"Status",sortable:!1},{key:"actions",sortable:!1,rowClass:"w-[1px] whitespace-nowrap"}],n=P(()=>{var f;return((f=t.value)==null?void 0:f.map(i=>{var a;return{id:i.id,targets:i.targets,index:i.index||"---",source:i.source!==void 0?i.source:"---",stats:{conditions:((a=i.conditions)==null?void 0:a.length)||0,...s(i.mapping||[])},status:i.status||"---"}}))||[]}),s=f=>{const i=f.filter(g=>g._type==="relation"),a={total:f.length,relations:i.length};return f.filter(g=>g._type==="relation").forEach(g=>{const{total:$,relations:V}=s(g.mapping||[]);a.total+=$,a.relations+=V}),a},u=j(!1),l=j("create"),c=j(),p=async()=>{l.value="create",c.value=void 0,u.value=!0},I=async f=>{var i,a;l.value="read",c.value=(a=(i=t.value)==null?void 0:i.filter(g=>g.id===f))==null?void 0:a.at(0),u.value=!0},_=async f=>{var i,a;l.value="edit",c.value=(a=(i=t.value)==null?void 0:i.filter(g=>g.id===f))==null?void 0:a.at(0),u.value=!0},C=async f=>{var i,a;l.value="create",c.value={...(a=(i=t.value)==null?void 0:i.filter(g=>g.id===f))==null?void 0:a.at(0)},u.value=!0},T=async f=>{var $;const{data:i,error:a,status:g}=await R(`/processors/${f}`,{method:"DELETE"});if(g.value==="error")E().add({color:"red",title:"Unable to delete processor",description:($=a.value)==null?void 0:$.message});else if(g.value==="success"){const V=i.value;E().add({color:"green",title:"Successfully deleted processor",description:V.message})}await d()},M=f=>{R(`/processors/${f}/index`,{method:"POST"}).then(({data:i,error:a,status:g})=>{var $,V,O;if(g.value==="error")E().add({color:"red",title:"Unable to indexing",description:((V=($=a.value)==null?void 0:$.data)==null?void 0:V.error)||((O=a.value)==null?void 0:O.message)});else if(g.value==="success"){const L=i.value;E().add({color:"green",title:"Successfully indexed",description:L.message})}})};return(f,i)=>{const a=ue,g=Ve,$=Me,V=Ee,O=de,L=pt;return b(),w("section",null,[h(O,{class:"w-full",ui:{divide:"divide-y divide-gray-200 dark:divide-gray-700",body:{padding:""},header:{base:"flex gap-x-2 justify-between items-center"},footer:{base:"text-sm leading-5 text-center"}}},{header:x(()=>[i[4]||(i[4]=v("h1",{class:"font-semibold text-xl text-gray-900 dark:text-white leading-tight"},"Processors",-1)),h(a,{onClick:k(p,["prevent"]),variant:"soft"},{default:x(()=>i[3]||(i[3]=[B("+ Add Processor")])),_:1})]),default:x(()=>[h(V,{onSelect:i[1]||(i[1]=y=>I(y.id)),columns:r,rows:m(n),sort:{column:"id",direction:"desc"},loading:m(o)==="pending"||m(o)==="idle"},{"actions-data":x(({row:y})=>[v("div",ft,[h(g,{items:[[{label:"Replicate",click:()=>C(y.id)},{label:"Claim indexing",click:()=>M(y.id),disabled:y.status==="indexing"}]],onClick:i[0]||(i[0]=k(()=>{},["stop"]))},{default:x(()=>[h(a,{icon:"i-heroicons-ellipsis-horizontal",variant:"link",color:"gray",size:"xl",padded:!1})]),_:2},1032,["items"]),h(a,{icon:"i-heroicons-eye",variant:"link",color:"gray",size:"xl",padded:!1,onClick:k(H=>I(y.id),["stop","prevent"])},null,8,["onClick"]),h(a,{icon:"i-heroicons-pencil-square",variant:"link",color:"gray",size:"xl",padded:!1,onClick:k(H=>_(y.id),["stop","prevent"])},null,8,["onClick"]),h(a,{icon:"i-heroicons-trash",variant:"link",color:"red",size:"xl",padded:!1,onClick:k(H=>T(y.id),["stop","prevent"])},null,8,["onClick"])])]),"targets-data":x(({row:y})=>[v("div",gt,[(b(!0),w(J,null,se(y.targets,H=>(b(),D($,{size:"xs",label:`Target n°${H}`,color:"sky",variant:"subtle"},null,8,["label"]))),256))])]),"source-data":x(({row:y})=>[v("div",yt,[h($,{size:"xs",label:`Source n°${y.source}`,color:"sky",variant:"subtle"},null,8,["label"])])]),"stats-data":x(({row:y})=>[v("div",bt,[h($,{size:"xs",label:`${y.stats.total} fields`,color:"gray"},null,8,["label"]),h($,{size:"xs",label:`${y.stats.relations} relations`,color:"gray"},null,8,["label"]),h($,{size:"xs",label:`${y.stats.conditions} conditions`,color:"gray"},null,8,["label"])])]),"status-data":x(({row:y})=>[h($,{size:"xs",label:y.status,color:{listening:"green",inactive:"red",indexing:"sky"}[y.status]||"gray"},null,8,["label","color"])]),_:1},8,["rows","loading"])]),footer:x(()=>{var y;return[i[5]||(i[5]=v("span",{class:"font-medium"},"Total: ",-1)),v("span",null,z(((y=m(n))==null?void 0:y.length)||0)+" processors",1)]}),_:1}),h(L,{onUpdated:m(d),onCreated:m(d),mode:m(l),opened:m(u),"onUpdate:opened":i[2]||(i[2]=y=>q(u)?u.value=y:null),processor:m(c)},null,8,["onUpdated","onCreated","mode","opened","processor"])])}}}),kt=Object.freeze(Object.defineProperty({__proto__:null,default:ht},Symbol.toStringTag,{value:"Module"}));export{Fe as _,Oe as d,Ae as e,kt as p,Q as u};
