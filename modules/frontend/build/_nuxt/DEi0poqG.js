import{p as Y,q as F,_ as J,g as C,x as G,y as I,h as R,f as v,r as q,L as P,ab as O,o,c as l,a as V,I as m,ak as p,av as y,K as b,F as k,d as w,t as $,J as z,aR as N,k as U,a9 as M,aS as T,O as Z,aT as D}from"./CD5hUaAV.js";const K={wrapper:"",inner:"",label:{wrapper:"flex content-center items-center justify-between",base:"block font-medium text-gray-700 dark:text-gray-200",required:"after:content-['*'] after:ms-0.5 after:text-red-500 dark:after:text-red-400"},size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base"},container:"mt-1 relative",description:"text-gray-500 dark:text-gray-400",hint:"text-gray-500 dark:text-gray-400",help:"mt-2 text-gray-500 dark:text-gray-400",error:"mt-2 text-red-500 dark:text-red-400",default:{size:"sm"}},B=Y(F.ui.strategy,F.ui.formGroup,K),L=C({inheritAttrs:!1,props:{name:{type:String,default:null},size:{type:String,default:null,validator(e){return Object.keys(B.size).includes(e)}},label:{type:String,default:null},description:{type:String,default:null},required:{type:Boolean,default:!1},help:{type:String,default:null},error:{type:[String,Boolean],default:null},hint:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},eagerValidation:{type:Boolean,default:!1}},setup(e){const{ui:a,attrs:n}=G("formGroup",I(e,"ui"),B,I(e,"class")),s=R("form-errors",null),u=v(()=>{var g,c;return e.error&&typeof e.error=="string"||typeof e.error=="boolean"?e.error:(c=(g=s==null?void 0:s.value)==null?void 0:g.find(S=>S.path===e.name))==null?void 0:c.message}),t=v(()=>a.value.size[e.size??B.default.size]),d=q(P());return O("form-group",{error:u,inputId:d,name:v(()=>e.name),size:v(()=>e.size),eagerValidation:v(()=>e.eagerValidation)}),{ui:a,attrs:n,inputId:d,size:t,error:u}}}),H=["for"];function Q(e,a,n,s,u,t){return o(),l("div",b({class:e.ui.wrapper},e.attrs),[V("div",{class:m(e.ui.inner)},[e.label||e.$slots.label?(o(),l("div",{key:0,class:m([e.ui.label.wrapper,e.size])},[V("label",{for:e.inputId,class:m([e.ui.label.base,e.required?e.ui.label.required:""])},[e.$slots.label?p(e.$slots,"label",y(b({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(o(),l(k,{key:1},[w($(e.label),1)],64))],10,H),e.hint||e.$slots.hint?(o(),l("span",{key:0,class:m([e.ui.hint])},[e.$slots.hint?p(e.$slots,"hint",y(b({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(o(),l(k,{key:1},[w($(e.hint),1)],64))],2)):z("",!0)],2)):z("",!0),e.description||e.$slots.description?(o(),l("p",{key:1,class:m([e.ui.description,e.size])},[e.$slots.description?p(e.$slots,"description",y(b({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(o(),l(k,{key:1},[w($(e.description),1)],64))],2)):z("",!0)],2),V("div",{class:m([e.label?e.ui.container:""])},[p(e.$slots,"default",y(N({error:e.error}))),typeof e.error=="string"&&e.error?(o(),l("p",{key:0,class:m([e.ui.error,e.size])},[e.$slots.error?p(e.$slots,"error",y(b({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(o(),l(k,{key:1},[w($(e.error),1)],64))],2)):e.help||e.$slots.help?(o(),l("p",{key:1,class:m([e.ui.help,e.size])},[e.$slots.help?p(e.$slots,"help",y(b({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(o(),l(k,{key:1},[w($(e.help),1)],64))],2)):z("",!0)],2)],16)}const ue=J(L,[["render",Q]]);class j extends Error{constructor(a){super(a),this.message=a,Object.setPrototypeOf(this,j.prototype)}}const W=C({props:{schema:{type:[Object,Function],default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]},validateOn:{type:Array,default:()=>["blur","input","change","submit"]}},emits:["submit","error"],setup(e,{expose:a,emit:n}){const s=P(),u=D(`form-${s}`);U(()=>{u.on(async r=>{var i;r.type!=="submit"&&((i=e.validateOn)!=null&&i.includes(r.type))&&await c(r.path,{silent:!0})})}),M(()=>{u.reset()});const t=q([]);O("form-errors",t),O("form-events",u);const d=q({});O("form-inputs",d);async function g(){let r=await e.validate(e.state);if(e.schema)if(ee(e.schema))r=r.concat(await re(e.state,e.schema));else if(X(e.schema))r=r.concat(await _(e.state,e.schema));else if(te(e.schema))r=r.concat(await se(e.state,e.schema));else if(ne(e.schema))r=r.concat(await ie(e.state,e.schema));else throw new Error("Form validation failed: Unsupported form schema");return r}async function c(r,i={silent:!1}){let f=r;if(r&&!Array.isArray(r)&&(f=[r]),f){const E=t.value.filter(h=>!f.includes(h.path)),A=(await g()).filter(h=>f.includes(h.path));t.value=E.concat(A)}else t.value=await g();if(t.value.length>0){if(i.silent)return!1;throw new j(`Form validation failed: ${JSON.stringify(t.value,null,2)}`)}return e.state}async function S(r){var f;const i=r;try{(f=e.validateOn)!=null&&f.includes("submit")&&await c(),i.data=e.state,n("submit",i)}catch(E){if(!(E instanceof j))throw E;const A={...i,errors:t.value.map(h=>({...h,id:d.value[h.path]}))};n("error",A)}}return a({validate:c,errors:t,setErrors(r,i){i?t.value=t.value.filter(f=>f.path!==i).concat(r):t.value=r},async submit(){await S(new Event("submit"))},getErrors(r){return r?t.value.filter(i=>i.path===r):t.value},clear(r){r?t.value=t.value.filter(i=>i.path!==r):t.value=[]}}),{onSubmit:S,errors:T(t)}}});function X(e){return e.validate&&e.__isYupSchema__}function x(e){return e.inner!==void 0}async function _(e,a){try{return await a.validate(e,{abortEarly:!1}),[]}catch(n){if(x(n))return n.inner.map(s=>({path:s.path??"",message:s.message}));throw n}}function ee(e){return e.parse!==void 0}async function re(e,a){const n=await a.safeParseAsync(e);return n.success===!1?n.error.issues.map(s=>({path:s.path.join("."),message:s.message})):[]}function te(e){return e.validateAsync!==void 0&&e.id!==void 0}function ae(e){return e.isJoi===!0}async function se(e,a){try{return await a.validateAsync(e,{abortEarly:!1}),[]}catch(n){if(ae(n))return n.details.map(s=>({path:s.path.join("."),message:s.message}));throw n}}function ne(e){return"_parse"in e||"_run"in e||typeof e=="function"&&"schema"in e}async function ie(e,a){var s;return((s=(await("_parse"in a?a._parse(e):"_run"in a?a._run({typed:!1,value:e},{}):a(e))).issues)==null?void 0:s.map(u=>{var t;return{path:((t=u.path)==null?void 0:t.map(d=>d.key).join("."))||"",message:u.message}}))||[]}function oe(e,a,n,s,u,t){return o(),l("form",{onSubmit:a[0]||(a[0]=Z((...d)=>e.onSubmit&&e.onSubmit(...d),["prevent"]))},[p(e.$slots,"default",y(N({errors:e.errors})))],32)}const de=J(W,[["render",oe]]);export{ue as _,de as a};
