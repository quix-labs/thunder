const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./C4TbN_WZ.js","./DEi0poqG.js","./CD5hUaAV.js","./entry.DSrKHs56.css","./CuAb3WZH.js","./useGoFetch.Cg6qBO-I.css","./C_TKe6c3.js","./B9rY3amy.js","./BwWMCXkI.js","./useSources.Be7ST0Az.css","./CQ5ZdX0U.js","./useTargets.DHNXSrSi.css","./RightPanel.Cg5M-ylL.css","./CKOdANVe.js","./SamplePanel._o2deULb.css","./D23cI2rW.js"])))=>i.map(i=>d[i]);
import{r as F,f as I,g as H,i as me,h as ve,s as fe,j as ge,k as be,l as ye,m as te,E as he,A as xe,T as ke,F as Q,n as ae,p as we,q as W,_ as oe,v as X,x as _e,y as se,z as $e,B as Se,C as G,D as Ce,G as le,o as h,H as B,w as k,a as b,I as D,c as _,b as y,J as C,K as Pe,L as Ie,M as ze,N as f,O as w,t as z,d as j,P as re,Q as R,R as ie,S as ne,U as Te,V as J,W as de,X as Y,Y as Z,Z as V,$ as Me,a0 as Ue}from"./CD5hUaAV.js";import{f as Ve,u as De,_ as ue,a as Oe,b as K,c as Ee,d as Ae,e as Be}from"./CuAb3WZH.js";const Le={base:"relative inline-flex flex-shrink-0 border-2 border-transparent disabled:cursor-not-allowed disabled:opacity-50 focus:outline-none",rounded:"rounded-full",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",active:"bg-{color}-500 dark:bg-{color}-400",inactive:"bg-gray-200 dark:bg-gray-700",size:{"2xs":"h-3 w-5",xs:"h-3.5 w-6",sm:"h-4 w-7",md:"h-5 w-9",lg:"h-6 w-11",xl:"h-7 w-[3.25rem]","2xl":"h-8 w-[3.75rem]"},container:{base:"pointer-events-none relative inline-block rounded-full bg-white dark:bg-gray-900 shadow transform ring-0 transition ease-in-out duration-200",active:{"2xs":"translate-x-2 rtl:-translate-x-2",xs:"translate-x-2.5 rtl:-translate-x-2.5",sm:"translate-x-3 rtl:-translate-x-3",md:"translate-x-4 rtl:-translate-x-4",lg:"translate-x-5 rtl:-translate-x-5",xl:"translate-x-6 rtl:-translate-x-6","2xl":"translate-x-7 rtl:-translate-x-7"},inactive:"translate-x-0 rtl:-translate-x-0",size:{"2xs":"h-2 w-2",xs:"h-2.5 w-2.5",sm:"h-3 w-3",md:"h-4 w-4",lg:"h-5 w-5",xl:"h-6 w-6","2xl":"h-7 w-7"}},icon:{base:"absolute inset-0 h-full w-full flex items-center justify-center transition-opacity",active:"opacity-100 ease-in duration-200",inactive:"opacity-0 ease-out duration-100",size:{"2xs":"h-2 w-2",xs:"h-2 w-2",sm:"h-2 w-2",md:"h-3 w-3",lg:"h-4 w-4",xl:"h-5 w-5","2xl":"h-6 w-6"},on:"text-{color}-500 dark:text-{color}-400",off:"text-gray-400 dark:text-gray-500",loading:"animate-spin text-{color}-500 dark:text-{color}-400"},default:{onIcon:null,offIcon:null,loadingIcon:"i-heroicons-arrow-path-20-solid",color:"primary",size:"md"}};function Ne(e,o,t){let p=F(t==null?void 0:t.value),i=I(()=>e.value!==void 0);return[I(()=>i.value?e.value:p.value),function(l){return i.value||(p.value=l),o==null?void 0:o(l)}]}function je(e={},o=null,t=[]){for(let[p,i]of Object.entries(e))pe(t,ce(o,p),i);return t}function ce(e,o){return e?e+"["+o+"]":o}function pe(e,o,t){if(Array.isArray(t))for(let[p,i]of t.entries())pe(e,ce(o,p.toString()),i);else t instanceof Date?e.push([o,t.toISOString()]):typeof t=="boolean"?e.push([o,t?"1":"0"]):typeof t=="string"?e.push([o,t]):typeof t=="number"?e.push([o,`${t}`]):t==null?e.push([o,""]):je(t,o,e)}function Ke(e){var o,t;let p=(o=e==null?void 0:e.form)!=null?o:e.closest("form");if(p){for(let i of p.elements)if(i!==e&&(i.tagName==="INPUT"&&i.type==="submit"||i.tagName==="BUTTON"&&i.type==="submit"||i.nodeName==="INPUT"&&i.type==="image")){i.click();return}(t=p.requestSubmit)==null||t.call(p)}}let Fe=Symbol("GroupContext"),Re=H({name:"Switch",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"button"},modelValue:{type:Boolean,default:void 0},defaultChecked:{type:Boolean,optional:!0},form:{type:String,optional:!0},name:{type:String,optional:!0},value:{type:String,optional:!0},id:{type:String,default:null},disabled:{type:Boolean,default:!1},tabIndex:{type:Number,default:0}},inheritAttrs:!1,setup(e,{emit:o,attrs:t,slots:p,expose:i}){var l;let n=(l=e.id)!=null?l:`headlessui-switch-${me()}`,d=ve(Fe,null),[r,v]=Ne(I(()=>e.modelValue),a=>o("update:modelValue",a),I(()=>e.defaultChecked));function u(){v(!r.value)}let T=F(null),$=d===null?T:d.switchRef,P=fe(I(()=>({as:e.as,type:t.type})),$);i({el:$,$el:$});function M(a){a.preventDefault(),u()}function O(a){a.key===ae.Space?(a.preventDefault(),u()):a.key===ae.Enter&&Ke(a.currentTarget)}function A(a){a.preventDefault()}let E=I(()=>{var a,s;return(s=(a=ge($))==null?void 0:a.closest)==null?void 0:s.call(a,"form")});return be(()=>{ye([E],()=>{if(!E.value||e.defaultChecked===void 0)return;function a(){v(e.defaultChecked)}return E.value.addEventListener("reset",a),()=>{var s;(s=E.value)==null||s.removeEventListener("reset",a)}},{immediate:!0})}),()=>{let{name:a,value:s,form:c,tabIndex:g,...x}=e,S={checked:r.value},U={id:n,ref:$,role:"switch",type:P.value,tabIndex:g===-1?0:g,"aria-checked":r.value,"aria-labelledby":d==null?void 0:d.labelledby.value,"aria-describedby":d==null?void 0:d.describedby.value,onClick:M,onKeyup:O,onKeypress:A};return te(Q,[a!=null&&r.value!=null?te(Ve,he({features:De.Hidden,as:"input",type:"checkbox",hidden:!0,readOnly:!0,checked:r.value,form:c,disabled:x.disabled,name:a,value:s})):null,xe({ourProps:U,theirProps:{...t,...ke(x,["modelValue","defaultChecked"])},slot:S,attrs:t,slots:p,name:"Switch"})])}}});const N=we(W.ui.strategy,W.ui.toggle,Le),He=H({components:{HSwitch:Re,UIcon:X},inheritAttrs:!1,props:{id:{type:String,default:null},name:{type:String,default:null},modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},onIcon:{type:String,default:()=>N.default.onIcon},offIcon:{type:String,default:()=>N.default.offIcon},loadingIcon:{type:String,default:()=>N.default.loadingIcon},color:{type:String,default:()=>N.default.color,validator(e){return W.ui.colors.includes(e)}},size:{type:String,default:()=>N.default.size,validator(e){return Object.keys(N.size).includes(e)}},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:o}){const{ui:t,attrs:p}=_e("toggle",se(e,"ui"),N),{emitFormChange:i,color:l,inputId:n,name:d}=$e(e),r=I({get(){return e.modelValue},set(M){o("update:modelValue",M),o("change",M),i()}}),v=I(()=>Se(G(t.value.base,t.value.size[e.size],t.value.rounded,l.value&&t.value.ring.replaceAll("{color}",l.value),l.value&&(r.value?t.value.active:t.value.inactive).replaceAll("{color}",l.value)),e.class)),u=I(()=>G(t.value.container.base,t.value.container.size[e.size],r.value?t.value.container.active[e.size]:t.value.container.inactive)),T=I(()=>G(t.value.icon.size[e.size],l.value&&t.value.icon.on.replaceAll("{color}",l.value))),$=I(()=>G(t.value.icon.size[e.size],l.value&&t.value.icon.off.replaceAll("{color}",l.value))),P=I(()=>G(t.value.icon.size[e.size],l.value&&t.value.icon.loading.replaceAll("{color}",l.value)));return Ce(()=>Ie()),{ui:t,attrs:p,name:d,inputId:n,active:r,switchClass:v,containerClass:u,onIconClass:T,offIconClass:$,loadingIconClass:P}}});function qe(e,o,t,p,i,l){const n=X,d=le("HSwitch");return h(),B(d,Pe({id:e.inputId,modelValue:e.active,"onUpdate:modelValue":o[0]||(o[0]=r=>e.active=r),name:e.name,disabled:e.disabled||e.loading,class:e.switchClass},e.attrs),{default:k(()=>[b("span",{class:D(e.containerClass)},[e.loading?(h(),_("span",{key:0,class:D([e.ui.icon.active,e.ui.icon.base]),"aria-hidden":"true"},[y(n,{name:e.loadingIcon,class:D(e.loadingIconClass)},null,8,["name","class"])],2)):C("",!0),!e.loading&&e.onIcon?(h(),_("span",{key:1,class:D([e.active?e.ui.icon.active:e.ui.icon.inactive,e.ui.icon.base]),"aria-hidden":"true"},[y(n,{name:e.onIcon,class:D(e.onIconClass)},null,8,["name","class"])],2)):C("",!0),!e.loading&&e.offIcon?(h(),_("span",{key:2,class:D([e.active?e.ui.icon.inactive:e.ui.icon.active,e.ui.icon.base]),"aria-hidden":"true"},[y(n,{name:e.offIcon,class:D(e.offIconClass)},null,8,["name","class"])],2)):C("",!0)],2)]),_:1},16,["id","modelValue","name","disabled","class"])}const Ge=oe(He,[["render",qe]]);function ee(){return ze("process-form",()=>se({activeTabs:"source",preventScroll:!1,shortMode:!1,liveReload:!0,showSamplePanel:!0}))}const Je={key:2,class:"italic opacity-60"},We={key:3},Qe={key:0,class:"text-gray-400 ml-2"},Xe=["onKeydown","onClick"],Ye={key:0,class:"italic text-sm"},Ze={key:1},et={key:1,class:"inline-flex items-baseline relative"},tt=H({__name:"MappingThree",props:{mapping:{default:()=>[]},name:{},as:{},path:{}},setup(e){const o=F(!1),t=ee(),p=async n=>{t.value.activeTabs="mapping",t.value.activeMappingPath=i(n)},i=n=>[e.path,n].filter(d=>d).join("."),l=n=>{var d;return((d=t.value.activeMappingPath)==null?void 0:d.startsWith(i(n)+"."))||t.value.activeMappingPath===i(n)||i(n)===""};return(n,d)=>{const r=X,v=le("MappingThree",!0);return h(),_("div",{tabindex:"0",class:D(["text-sm leading-tight",{"font-bold":i("")===(f(t).activeMappingPath||"")}]),onClick:d[3]||(d[3]=w(u=>p(""),["prevent","stop"])),onKeydown:d[4]||(d[4]=R(w(u=>p(""),["prevent","stop"]),["enter","space"]))},[b("div",{class:D(["inline-flex items-baseline leading-normal relative w-full dark:hover:bg-white/5 hover:bg-primary/5",{underline:i("")===(f(t).activeMappingPath||"")}])},[n.path&&!f(o)?(h(),B(r,{key:0,class:"carret hover:text-sky-600",name:"i-heroicons-chevron-down",onClick:d[0]||(d[0]=w(u=>o.value=!0,["prevent","stop"]))})):n.path?(h(),B(r,{key:1,class:"carret hover:text-sky-600",name:"i-heroicons-chevron-right",onClick:d[1]||(d[1]=w(u=>o.value=!1,["prevent","stop"]))})):C("",!0),n.name&&n.name!==n.as?(h(),_("span",Je,z(n.name)+": ",1)):C("",!0),n.as?(h(),_("span",We,z(n.as)+" ",1)):C("",!0),b("p",{onClick:d[2]||(d[2]=w(u=>o.value=!f(o),["prevent","stop"])),class:"hover:text-sky-600"},[j(z(f(o)?"{...}":"{")+" ",1),f(o)?(h(),_("span",Qe,z(n.mapping.length>=2?`// ${n.mapping.length} items`:`// ${n.mapping.length} item`),1)):C("",!0)])],2),f(o)?C("",!0):(h(!0),_(Q,{key:0},re(n.mapping,u=>(h(),_("div",{class:D(["pl-4 cursor-pointer dark:hover:bg-white/5 hover:bg-primary/5",{"border-l border-dashed":!0,"border-sky-600 dark:border-green-400/60":l(""),"border-[#bfcbd9]":!l("")}])},[u._type==="simple"?(h(),_("p",{key:0,class:D({"font-bold underline":i(u.column)===(f(t).activeMappingPath||"")}),onKeydown:R(w(T=>p(u.column),["prevent","stop"]),["enter","space"]),onClick:w(T=>p(u.column),["prevent","stop"]),tabindex:"0"},[u.name&&u.name!==u.column?(h(),_("span",Ye,z(u.name)+": ",1)):C("",!0),u.column?(h(),_("span",Ze,z(u.column),1)):C("",!0)],42,Xe)):u._type==="relation"?(h(),B(v,{key:1,mapping:u.mapping,name:u.table,as:u.name,path:i(u.name)},null,8,["mapping","name","as","path"])):C("",!0)],2))),256)),f(o)?C("",!0):(h(),_("span",et,"}"))],34)}}}),at=oe(tt,[["__scopeId","data-v-a6e5187f"]]),nt={class:"flex flex-col flex-1 gap-y-4 max-h-screen overflow-auto p-4"},ot={class:"font-semibold"},st={class:"font-normal"},lt={class:"font-semibold"},rt={class:"font-normal"},it=H({__name:"LeftPanel",props:{form:{required:!0},formModifiers:{}},emits:["update:form"],setup(e){const o=ie(e,"form"),t=ee();function p(i){t.value.activeTabs=i}return(i,l)=>{const n=ue,d=at;return h(),_("div",nt,[y(n,{tabindex:"0",class:"cursor-pointer",onClick:l[0]||(l[0]=w(r=>p("source"),["prevent"])),onKeydown:l[1]||(l[1]=R(r=>p("source"),["enter","space"])),ui:f(t).activeTabs==="source"?{ring:"ring-1 ring-primary dark:ring-primary"}:void 0},{header:k(()=>l[6]||(l[6]=[b("p",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Source ",-1),b("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Describe which data will be synchronized ",-1)])),default:k(()=>{var r;return[b("p",null,"Source: Source n°"+z(o.value.source),1),b("p",null,"Table: "+z(o.value.table||"---"),1),b("p",null,"Conditions: "+z(((r=o.value.conditions)==null?void 0:r.length)||"---")+" TODO",1)]}),_:1},8,["ui"]),y(n,{tabindex:"0",class:"flex-1 cursor-pointer",onClick:l[2]||(l[2]=w(r=>p("mapping"),["prevent"])),onKeydown:l[3]||(l[3]=R(r=>p("mapping"),["enter","space"])),ui:f(t).activeTabs==="mapping"?{ring:"ring-1 ring-primary dark:ring-primary"}:void 0},{header:k(()=>l[7]||(l[7]=[b("p",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Mapping ",-1),b("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Describe how to transform your relational data into unstructured documents ",-1)])),default:k(()=>[y(d,{mapping:o.value.mapping,name:o.value.table,as:o.value.index},null,8,["mapping","name","as"])]),_:1},8,["ui"]),y(n,{tabindex:"0",class:"cursor-pointer",onClick:l[4]||(l[4]=w(r=>p("output"),["prevent"])),onKeydown:l[5]||(l[5]=R(r=>p("output"),["enter","space"])),ui:f(t).activeTabs==="output"?{ring:"ring-1 ring-primary dark:ring-primary"}:void 0},{header:k(()=>l[8]||(l[8]=[b("p",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Output ",-1),b("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Describe how your data will be synchronized ",-1)])),default:k(()=>{var r,v;return[b("p",ot,[l[9]||(l[9]=j(" Targets: ")),b("span",st,z((v=(r=o.value.targets)==null?void 0:r.map(u=>`Target n°${u}`))==null?void 0:v.join(", ")),1)]),b("p",lt,[l[10]||(l[10]=j(" Expected index: ")),b("span",rt,z(o.value.index),1)])]}),_:1},8,["ui"])])}}}),dt=Y(()=>Z(()=>import("./C4TbN_WZ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url).then(e=>e.default||e)),ut=Y(()=>Z(()=>import("./CKOdANVe.js"),__vite__mapDeps([13,2,3,4,5,14]),import.meta.url).then(e=>e.default||e)),ct={class:"flex flex-col flex-1 relative"},pt={class:"col-span-full flex justify-between border-b p-4"},mt={class:"flex gap-x-4"},vt={key:0,class:"flex items-center gap-x-4 cursor-pointer"},ft={class:"flex items-center gap-x-4 cursor-pointer"},gt=H({__name:"Complete",props:ne({mode:{default:"create"},processor:{}},{opened:{},openedModifiers:{}}),emits:ne(["created","updated"],["update:opened"]),setup(e,{emit:o}){const t=ie(e,"opened"),p=o,i=ee(),l=Te({source:null,table:null,primary_keys:[],conditions:[],targets:[],index:null,mapping:[]}),n=I(()=>e.processor||l),d=async()=>{var r,v,u,T;if(e.mode==="create"){const{status:$,error:P,data:M}=await K("/processors",{method:"post",body:n,watch:!1});if($.value==="success"){const O=M.value;V().add({title:"Success",color:"green",description:O.message}),p("created"),t.value=!1;return}$.value==="error"&&V().add({title:"Error",description:(r=P.value)==null?void 0:r.message,color:"red"})}else if(e.mode==="edit"){const{status:$,error:P,data:M}=await K(`/processors/${e.processor.id}`,{method:"put",body:n,watch:!1});if($.value==="success"){const O=M.value;V().add({title:"Success",color:"green",description:O.message}),p("updated"),t.value=!1;return}$.value==="error"&&V().add({title:"Error",description:((u=(v=P==null?void 0:P.value)==null?void 0:v.data)==null?void 0:u.error)||((T=P.value)==null?void 0:T.message),color:"red"})}};return(r,v)=>{const u=Ge,T=it,$=dt,P=ut,M=de,O=Oe;return h(),_("section",ct,[y(O,{modelValue:t.value,"onUpdate:modelValue":v[5]||(v[5]=A=>t.value=A),class:"overflow-y-auto",onKeydown:R(w(d,["ctrl","prevent"]),["enter"]),ui:f(i).showSamplePanel?r.mode==="read"?{width:"w-screen max-w-[40vw]"}:{width:"w-screen max-w-[70vw]"}:r.mode==="read"?{width:"w-screen max-w-[25vw]"}:{width:"w-screen max-w-[55vw]"}},{default:k(()=>{var A,E;return[b("div",{class:D(["grid min-h-screen grid-rows-[auto_1fr_auto]",{"grid-cols-[2fr_3fr]":r.mode!=="read"&&!f(i).showSamplePanel,"grid-cols-[2fr_3fr_15vw]":r.mode!=="read"&&f(i).showSamplePanel,"grid-cols-[1fr_15vw]":f(i).showSamplePanel&&r.mode=="read"}])},[b("div",pt,[b("h2",{onClick:w(d,["prevent"]),class:"col-span-full text-center text-2xl font-semibold"},z({create:"New processor",edit:`Edit processor: ${(A=r.processor)==null?void 0:A.id}`,read:`Processor: ${(E=r.processor)==null?void 0:E.id}`}[r.mode]),1),b("div",mt,[r.mode!=="read"?(h(),_("label",vt,[v[6]||(v[6]=j(" Short Mode (beta): ")),y(u,{"on-icon":"i-heroicons-check-20-solid","off-icon":"i-heroicons-x-mark-20-solid",modelValue:f(i).shortMode,"onUpdate:modelValue":v[0]||(v[0]=a=>f(i).shortMode=a)},null,8,["modelValue"])])):C("",!0),b("label",ft,[v[7]||(v[7]=j(" Sample Tab: ")),y(u,{"on-icon":"i-heroicons-check-20-solid","off-icon":"i-heroicons-x-mark-20-solid",modelValue:f(i).showSamplePanel,"onUpdate:modelValue":v[1]||(v[1]=a=>f(i).showSamplePanel=a)},null,8,["modelValue"])])])]),y(T,{form:f(n),"onUpdate:form":v[2]||(v[2]=a=>J(n)?n.value=a:null)},null,8,["form"]),r.mode!=="read"?(h(),B($,{key:0,form:f(n),"onUpdate:form":v[3]||(v[3]=a=>J(n)?n.value=a:null)},null,8,["form"])):C("",!0),f(i).showSamplePanel?(h(),B(P,{key:1,form:f(n),"onUpdate:form":v[4]||(v[4]=a=>J(n)?n.value=a:null)},null,8,["form"])):C("",!0),r.mode!=="read"?(h(),B(M,{key:2,class:"col-span-full",onClick:w(d,["prevent"]),size:"xl",block:"",ui:{rounded:""}},{default:k(()=>[j(z({create:"Create",edit:"Save changes"}[r.mode]),1)]),_:1})):C("",!0)],2)]}),_:1},8,["modelValue","onKeydown","ui"])])}}}),bt=Y(()=>Z(()=>import("./D23cI2rW.js"),__vite__mapDeps([15,2,3,1,7,4,5]),import.meta.url).then(e=>e.default||e.default||e)),yt={class:"flex gap-1"},ht={class:"flex gap-1"},xt={class:"flex gap-1"},kt={class:"flex gap-1"},wt=H({__name:"processors",setup(e){const{status:o,data:t}=Me(),p=[{key:"id",label:"#",sortable:!0,rowClass:"w-[1px] whitespace-nowrap"},{key:"source",label:"Source",sortable:!0},{key:"index",label:"Index",sortable:!0},{key:"targets",label:"Targets",sortable:!0},{key:"stats",label:"Stats",sortable:!1},{key:"listening",label:"Listening",sortable:!0},{key:"indexing",label:"Indexing",sortable:!0},{key:"actions",sortable:!1,rowClass:"w-[1px] whitespace-nowrap"}],i=I(()=>{var a;return((a=t.value)==null?void 0:a.map(s=>{var c;return{id:s.id,targets:s.targets,index:s.index||"---",source:s.source!==void 0?s.source:"---",stats:{conditions:((c=s.conditions)==null?void 0:c.length)||0,...l(s.mapping||[])},indexing:s.indexing||!1,listening:s.listening||!1}}))||[]}),l=a=>{const s=a.filter(g=>g._type==="relation"),c={total:a.length,relations:s.length};return a.filter(g=>g._type==="relation").forEach(g=>{const{total:x,relations:S}=l(g.mapping||[]);c.total+=x,c.relations+=S}),c},n=F(!1),d=F("create"),r=F(),v=async()=>{d.value="create",r.value=void 0,n.value=!0},u=async a=>{var s,c;d.value="read",r.value=(c=(s=t.value)==null?void 0:s.filter(g=>g.id===a))==null?void 0:c.at(0),n.value=!0},T=async a=>{var s,c;d.value="edit",r.value=(c=(s=t.value)==null?void 0:s.filter(g=>g.id===a))==null?void 0:c.at(0),n.value=!0},$=async a=>{var s,c;d.value="create",r.value={...(c=(s=t.value)==null?void 0:s.filter(g=>g.id===a))==null?void 0:c.at(0)},n.value=!0},P=async a=>{var x;const{data:s,error:c,status:g}=await K(`/processors/${a}`,{method:"DELETE"});if(g.value==="error")V().add({color:"red",title:"Unable to delete processor",description:(x=c.value)==null?void 0:x.message});else if(g.value==="success"){const S=s.value;V().add({color:"green",title:"Successfully deleted processor",description:S.message})}},M=a=>{Ue().open(bt,{processorId:a})},O=a=>{K(`/processors/${a}/index`,{method:"POST"}).then(({data:s,error:c,status:g})=>{var x,S,U;if(g.value==="error")V().add({color:"red",title:"Unable to indexing",description:((S=(x=c.value)==null?void 0:x.data)==null?void 0:S.error)||((U=c.value)==null?void 0:U.message)});else if(g.value==="success"){const L=s.value;V().add({color:"green",title:"Successfully indexed",description:L.message})}})},A=a=>{K(`/processors/${a}/start`,{method:"POST"}).then(({data:s,error:c,status:g})=>{var x,S,U;if(g.value==="error")V().add({color:"red",title:"Unable to start",description:((S=(x=c.value)==null?void 0:x.data)==null?void 0:S.error)||((U=c.value)==null?void 0:U.message)});else if(g.value==="success"){const L=s.value;V().add({color:"green",title:"Successfully started",description:L.message})}})},E=a=>{K(`/processors/${a}/stop`,{method:"POST"}).then(({data:s,error:c,status:g})=>{var x,S,U;if(g.value==="error")V().add({color:"red",title:"Unable to stop",description:((S=(x=c.value)==null?void 0:x.data)==null?void 0:S.error)||((U=c.value)==null?void 0:U.message)});else if(g.value==="success"){const L=s.value;V().add({color:"green",title:"Successfully stopped",description:L.message})}})};return(a,s)=>{const c=de,g=Ee,x=Ae,S=Be,U=ue,L=gt;return h(),_("section",null,[y(U,{class:"w-full",ui:{divide:"divide-y divide-gray-200 dark:divide-gray-700",body:{padding:""},header:{base:"flex gap-x-2 justify-between items-center"},footer:{base:"text-sm leading-5 text-center"}}},{header:k(()=>[s[4]||(s[4]=b("h1",{class:"font-semibold text-xl text-gray-900 dark:text-white leading-tight"},"Processors",-1)),y(c,{onClick:w(v,["prevent"]),variant:"soft"},{default:k(()=>s[3]||(s[3]=[j("+ Add Processor")])),_:1})]),default:k(()=>[y(S,{onSelect:s[1]||(s[1]=m=>u(m.id)),columns:p,rows:f(i),sort:{column:"id",direction:"desc"},loading:f(o)==="pending"||f(o)==="idle"},{"actions-data":k(({row:m})=>[b("div",yt,[y(g,{items:[[{label:"Replicate",click:()=>$(m.id)},{label:"Claim indexing",click:()=>O(m.id),disabled:m.indexing},{label:"Start listening",click:()=>A(m.id),disabled:m.listening},{label:"Stop listening",click:()=>E(m.id),disabled:!m.listening}]],onClick:s[0]||(s[0]=w(()=>{},["stop"]))},{default:k(()=>[y(c,{icon:"i-heroicons-ellipsis-horizontal",variant:"link",color:"gray",size:"xl",padded:!1})]),_:2},1032,["items"]),y(c,{icon:"i-heroicons-eye",variant:"link",color:"gray",size:"xl",padded:!1,onClick:w(q=>u(m.id),["stop","prevent"])},null,8,["onClick"]),y(c,{icon:"i-heroicons-pencil-square",variant:"link",color:"gray",size:"xl",padded:!1,onClick:w(q=>T(m.id),["stop","prevent"])},null,8,["onClick"]),y(c,{icon:"i-heroicons-document-arrow-down",variant:"link",color:"primary",size:"xl",padded:!1,onClick:w(q=>M(m.id),["stop","prevent"])},null,8,["onClick"]),y(c,{icon:"i-heroicons-trash",variant:"link",color:"red",size:"xl",padded:!1,onClick:w(q=>P(m.id),["stop","prevent"])},null,8,["onClick"])])]),"targets-data":k(({row:m})=>[b("div",ht,[(h(!0),_(Q,null,re(m.targets,q=>(h(),B(x,{size:"xs",label:`Target n°${q}`,color:"sky",variant:"subtle"},null,8,["label"]))),256))])]),"source-data":k(({row:m})=>[b("div",xt,[y(x,{size:"xs",label:`Source n°${m.source}`,color:"sky",variant:"subtle"},null,8,["label"])])]),"stats-data":k(({row:m})=>[b("div",kt,[y(x,{size:"xs",label:`${m.stats.total} fields`,color:"gray"},null,8,["label"]),y(x,{size:"xs",label:`${m.stats.relations} relations`,color:"gray"},null,8,["label"]),y(x,{size:"xs",label:`${m.stats.conditions} conditions`,color:"gray"},null,8,["label"])])]),"indexing-data":k(({row:m})=>[y(x,{size:"xs",label:m.indexing?"Indexing":"Not indexing",color:m.indexing?"green":"red"},null,8,["label","color"])]),"listening-data":k(({row:m})=>[y(x,{size:"xs",label:m.listening?"Listening":"Not listening",color:m.listening?"green":"red"},null,8,["label","color"])]),_:1},8,["rows","loading"])]),footer:k(()=>{var m;return[s[5]||(s[5]=b("span",{class:"font-medium"},"Total: ",-1)),b("span",null,z(((m=f(i))==null?void 0:m.length)||0)+" processors",1)]}),_:1}),y(L,{mode:f(d),opened:f(n),"onUpdate:opened":s[2]||(s[2]=m=>J(n)?n.value=m:null),processor:f(r)},null,8,["mode","opened","processor"])])}}}),St=Object.freeze(Object.defineProperty({__proto__:null,default:wt},Symbol.toStringTag,{value:"Module"}));export{Ge as _,Ne as d,je as e,St as p,ee as u};
